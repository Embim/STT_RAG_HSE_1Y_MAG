# RAG Pipeline –¥–ª—è –õ–µ–∫—Ü–∏–π

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–µ–∫—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º RAG (Retrieval-Augmented Generation).

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü–∞–π–ø–ª–∞–π–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö** - —á—Ç–µ–Ω–∏–µ JSON —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–∞–ø–∫–∏ `transcripted_text`
2. **Chunking** - —Ä–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —á–∞–Ω–∫–∏ (—Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã) —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º
3. **–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –≤–µ–∫—Ç–æ—Ä—ã —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏ `Qwen/Qwen3-Embedding-0.6B`
4. **–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤ Weaviate (–≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
5. **Retrieval** - –ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –ø–æ –∑–∞–ø—Ä–æ—Å—É

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ transcripted_text/        # –ü–∞–ø–∫–∞ —Å JSON —Ñ–∞–π–ª–∞–º–∏ –ª–µ–∫—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ lecture_0.json
‚îÇ   ‚îú‚îÄ‚îÄ lecture_1.json
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ rag_pipeline.py           # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω
‚îú‚îÄ‚îÄ interactive_search.py     # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫
‚îú‚îÄ‚îÄ stats.py                  # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±–∞–∑–µ
‚îú‚îÄ‚îÄ RAG.py                    # –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ docker-compose.yml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker Compose
‚îú‚îÄ‚îÄ quickstart.bat            # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Windows)
‚îú‚îÄ‚îÄ quickstart.sh             # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Linux/Mac)
‚îî‚îÄ‚îÄ README.md                 # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ Weaviate

Weaviate - —ç—Ç–æ –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.

**–í–∞—Ä–∏–∞–Ω—Ç 1: Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

```bash
docker run -d \
  -p 8080:8080 \
  -p 50051:50051 \
  --name weaviate \
  semitechnologies/weaviate:latest
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: Docker Compose**

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `docker-compose.yml`:

```yaml
version: '3.4'
services:
  weaviate:
    image: semitechnologies/weaviate:latest
    ports:
      - "8080:8080"
      - "50051:50051"
    environment:
      QUERY_DEFAULTS_LIMIT: 25
      AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED: 'true'
      PERSISTENCE_DATA_PATH: '/var/lib/weaviate'
      DEFAULT_VECTORIZER_MODULE: 'none'
      ENABLE_MODULES: ''
      CLUSTER_HOSTNAME: 'node1'
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
docker-compose up -d
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Weaviate

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:8080/v1/meta

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å JSON —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ Weaviate.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:

**Windows:**
```bash
quickstart.bat
```

**Linux/Mac:**
```bash
chmod +x quickstart.sh
./quickstart.sh
```

–≠—Ç–∏ —Å–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–≤–µ—Ä—è—Ç, —á—Ç–æ Weaviate –∑–∞–ø—É—â–µ–Ω
- –£—Å—Ç–∞–Ω–æ–≤—è—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ó–∞–ø—É—Å—Ç—è—Ç –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é

### –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞

–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –ª–µ–∫—Ü–∏–∏ –∏ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –∏—Ö –≤ Weaviate:

```bash
python rag_pipeline.py
```

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫

–ü–æ—Å–ª–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫:

```bash
python interactive_search.py
```

–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:
```
üîç –í–∞—à –∑–∞–ø—Ä–æ—Å: –ß—Ç–æ —Ç–∞–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ?

–ü–æ–∏—Å–∫...

================================================================================
–ù–∞–π–¥–µ–Ω–æ 5 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤:
================================================================================

#1 | –°—Ö–æ–¥—Å—Ç–≤–æ: 0.8765 | lecture_0.json (chunk 2)
--------------------------------------------------------------------------------
–ß–µ–º –º—ã –±—É–¥–µ–º —Å –≤–∞–º–∏ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è? –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø—Ä–∏–≤–æ–¥–∏—Ç—å —Ç–∞–∫–æ–π –ø—Ä–∏–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π
–æ–±—ä—è—Å–Ω—è–µ—Ç –≤–æ–æ–±—â–µ —Å—É—Ç—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è...
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±–∞–∑–µ

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ª–µ–∫—Ü–∏—è–º:

```bash
python stats.py
```

–í—ã–≤–æ–¥–∏—Ç:
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ª–µ–∫—Ü–∏–π
- –¢–æ–ø –ª–µ–∫—Ü–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —á–∞–Ω–∫–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º —á–∞–Ω–∫–æ–≤

### –≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã –ø–∞–π–ø–ª–∞–π–Ω–∞

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –ª–µ–∫—Ü–∏–π** - –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ —Ñ–∞–π–ª—ã `lecture_*.json` –∏–∑ –ø–∞–ø–∫–∏ `transcripted_text`
2. **–†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏** - –∫–∞–∂–¥–∞—è –ª–µ–∫—Ü–∏—è —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –ø–æ 500 —Å–ª–æ–≤ —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º –≤ 50 —Å–ª–æ–≤
3. **–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –∫–∞–∂–¥—ã–π —á–∞–Ω–∫ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é 768 (–¥–ª—è –º–æ–¥–µ–ª–∏ Qwen3-Embedding-0.6B)
4. **–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è** - –≤–µ–∫—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ Weaviate
5. **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞** - –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã:

- "–ß—Ç–æ —Ç–∞–∫–æ–µ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ?"
- "–ö–∞–∫–∏–µ –±—ã–≤–∞—é—Ç —Ç–∏–ø—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤?"
- "–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ —Ä–µ–≥—Ä–µ—Å—Å–∏—é"

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–í —Ñ–∞–π–ª–µ [rag_pipeline.py](rag_pipeline.py) –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```python
# –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è–º–∏
TRANSCRIPTS_FOLDER = r"c:\Users\petrc\OneDrive\–ú–∞–≥–∞\–ì–æ–¥–æ–≤–æ–π –ø—Ä–æ–µ–∫—Ç\transcripted_text"

# –†–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –≤ —Å–ª–æ–≤–∞—Ö
CHUNK_SIZE = 500

# –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –º–µ–∂–¥—É —á–∞–Ω–∫–∞–º–∏ –≤ —Å–ª–æ–≤–∞—Ö
OVERLAP = 50

# URL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Weaviate
WEAVIATE_URL = "http://localhost:8080"
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–≤–æ–µ–º –∫–æ–¥–µ

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫

```python
from rag_pipeline import EmbeddingModel, WeaviateIndexer, RAGRetriever

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
embedding_model = EmbeddingModel()
indexer = WeaviateIndexer(url="http://localhost:8080")
indexer.connect()

retriever = RAGRetriever(indexer, embedding_model)

# –ü–æ–∏—Å–∫
results = retriever.retrieve("–ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏?", top_k=5)
retriever.display_results(results)

# –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
indexer.close()
```

### –ü—Ä–∏–º–µ—Ä 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –ª–µ–∫—Ü–∏–π

```python
from rag_pipeline import LectureProcessor, TextChunker, EmbeddingModel, WeaviateIndexer

# –ó–∞–≥—Ä—É–∑–∫–∞
processor = LectureProcessor("–ø—É—Ç—å/–∫/–ø–∞–ø–∫–µ")
lectures = processor.load_lectures()

# –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏
chunker = TextChunker(chunk_size=500, overlap=50)
chunks = chunker.process_lectures(lectures)

# –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
embedding_model = EmbeddingModel()
chunks_with_embeddings = embedding_model.encode_chunks(chunks)

# –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è
indexer = WeaviateIndexer()
indexer.connect()
indexer.create_schema()
indexer.index_chunks(chunks_with_embeddings)
indexer.close()
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–ª–∞—Å—Å—ã

1. **LectureProcessor** - –∑–∞–≥—Ä—É–∑–∫–∞ –ª–µ–∫—Ü–∏–π –∏–∑ JSON —Ñ–∞–π–ª–æ–≤
2. **TextChunker** - —Ä–∞–∑–±–∏–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —á–∞–Ω–∫–∏ —Å –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ–º
3. **EmbeddingModel** - –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ `sentence-transformers`
4. **WeaviateIndexer** - —Ä–∞–±–æ—Ç–∞ —Å Weaviate (—Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã, –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è)
5. **RAGRetriever** - –ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

**–í—Ö–æ–¥–Ω–æ–π JSON (lecture_N.json):**
```json
{
  "hash": "QVs8QjuAN74",
  "text": "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –ª–µ–∫—Ü–∏–∏...",
  "segments": [...]
}
```

**–ß–∞–Ω–∫ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ):**
```python
{
  "text": "–¢–µ–∫—Å—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞...",
  "chunk_id": 0,
  "lecture_id": "lecture_0",
  "lecture_hash": "QVs8QjuAN74",
  "filename": "lecture_0.json",
  "word_start": 0,
  "word_end": 500,
  "total_words": 5000,
  "embedding": [0.123, -0.456, ...]  # –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ 768
}
```

## –ú–æ–¥–µ–ª—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å **Qwen/Qwen3-Embedding-0.6B**:

- –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤: 768
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ (`prompt_name="query"`)

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–î–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å flash attention:

```python
model = SentenceTransformer(
    "Qwen/Qwen3-Embedding-0.6B",
    model_kwargs={
        "attn_implementation": "flash_attention_2",
        "device_map": "auto"
    },
    tokenizer_kwargs={"padding_side": "left"}
)
```

–î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
```bash
pip install flash-attn
```

## Troubleshooting

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Weaviate

```
–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Weaviate: ...
```

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Weaviate –∑–∞–ø—É—â–µ–Ω: `docker ps`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: http://localhost:8080/v1/meta

### Out of Memory –ø—Ä–∏ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

```
RuntimeError: CUDA out of memory
```

**–†–µ—à–µ–Ω–∏–µ:**
- –£–º–µ–Ω—å—à–∏—Ç–µ `batch_size` –≤ `encode_chunks()`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CPU –≤–º–µ—Å—Ç–æ GPU: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `device='cpu'` –≤ SentenceTransformer

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ flash-attention (—Å–º. –≤—ã—à–µ)
- –£–≤–µ–ª–∏—á—å—Ç–µ `batch_size` –¥–ª—è –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ chunking

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–∑–±–∏–µ–Ω–∏—è:

1. **–ü–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å NLTK –∏–ª–∏ spaCy –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –ø–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º
2. **–ü–æ —Å–µ–º–∞–Ω—Ç–∏–∫–µ** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å semantic chunking
3. **–ü–æ fixed tokens** - —Ä–∞–∑–±–∏–µ–Ω–∏–µ –ø–æ —Ç–æ–∫–µ–Ω–∞–º –≤–º–µ—Å—Ç–æ —Å–ª–æ–≤

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

–í —Å—Ö–µ–º—É Weaviate –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

```python
{"name": "speaker", "dataType": ["text"]},
{"name": "timestamp", "dataType": ["date"]},
{"name": "topic", "dataType": ["text"]},
```

### –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫

Weaviate –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (–≤–µ–∫—Ç–æ—Ä–Ω—ã–π + BM25):

```python
results = collection.query.hybrid(
    query="–∑–∞–ø—Ä–æ—Å",
    limit=5,
    alpha=0.75  # –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–Ω—ã–º (1.0) –∏ keyword (0.0)
)
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
